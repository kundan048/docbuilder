<% include ../partials/home_header %>
<link rel="stylesheet" href="https://kendo.cdn.telerik.com/2019.1.220/styles/kendo.common-material.min.css"/>
<link rel="stylesheet" href="https://kendo.cdn.telerik.com/2019.1.220/styles/kendo.material.min.css"/>
<link rel="stylesheet" href="https://kendo.cdn.telerik.com/2019.1.220/styles/kendo.material.mobile.min.css"/>
<!-- <link rel="stylesheet" href="http://kendo.cdn.telerik.com/2019.1.220/styles/kendo.common.min.css"> -->
<link rel="stylesheet" href="https://kendo.cdn.telerik.com/2019.1.220/styles/kendo.blueopal.min.css"/>

<script src="http://kendo.cdn.telerik.com/2019.1.220/js/jquery.min.js"></script>
<script src="https://kendo.cdn.telerik.com/2019.1.220/js/kendo.all.min.js"></script>
<script>
    if (typeof jQuery == "undefined") {
        // fallback to local jQuery
        document.write(decodeURIComponent('%3Cscript src="/path/to/local/jquery.min.js" %3E%3C/script%3E'));
    }
</script>

<script src="http://kendo.cdn.telerik.com/2019.1.220/js/kendo.all.min.js"></script>


<link rel="stylesheet" href="../../css/suggestions.css">
<link rel="stylesheet" href="../../css/homepage.css">

<link rel="stylesheet" href="../../css/card.css">

<% include ../partials/home_navbar %>
<main role="main">
    <a class="btn btn-danger btn-outline-danger m-3" href="javascript:history.back()">Back</a>
    <a class="btn btn-primary btn-outline-primary m-3" href="/otherFormats/bulkVisitingCards">Bulk Visiting Card</a>
    <div class="h2 text-center mb-5">Uploaded Data</div>

    <div class="container">

        <div class="container">
            <div class="row">
                <div class="text-center">Sample Card</div>
                <div class="col-md-12">
                    <div id="download_pdf" class="card-container">
                        <section class="student-id">
                            <div class="container-fluid studs">
                                <div class="left">
                                    <div class="h5">Name - <%= result[1].name %></div>
                                    <div class="h6">Organization - <%= result[1].organization %></div>
                                    <div class="company"><%= result[1].designation %></div>
                                </div>
                                <div class="right">
                                    <div class="mobile"><%= result[1].contact_number %></div>
                                    <div class="address"><%= result[1].address %></div>
                                </div>
                            </div>
                        </section>
                        <br>
                        <br>
                        <br>

                    </div>
                </div>
            </div>
        </div>
        <div id="grid"></div>
        <br>
        <br>
        <input type="button" onclick="printDivMain()" class="btn btn-success" value="Download All">
        <br>
        <br>
        <br>

        <% var sample_data = result %>
        <span id='variableJSON' hidden>
            <%= JSON.stringify(result); %>
        </span>
    </div>


<!-- Hidden content to activate printing of all the data simultaneously -->
    
    <% sample_data.forEach(function(item){ %>
        <div class="container" style="display : none;">
            <div class="row">
                <div class="col-md-12">
                    <div id="download_pdf" class="card-container">
                        <section class="student-id">
                            <div class="container-fluid studs printMe">
                                <div class="left">
                                    <div class="h5">Name - <%= item.name %></div>
                                    <div class="h6">Organization - <%= item.organization %></div>
                                    <div class="company"><%= item.designation %></div>
                                </div>
                                <div class="right">
                                    <div class="mobile"><%= item.contact_number %></div>
                                    <div class="address"><%= item.address %></div>
                                </div>
                            </div>
                        </section>
                        <br>
                        <br>
                        <br>

                    </div>
                </div>
            </div>
        </div>
    <% }) %>

</main>

<% include ../partials/footer_script %>

<script>
        function printDivMain() {
            console.log("fdkh");
            var divsToPrint = document.getElementsByClassName('printMe'), n;

            for (n = 0; n < divsToPrint.length; n++) {
                printDiv(divsToPrint[n]);
            }
            function printDiv(div){
                // var printContents = document.getElementById(divName).innerHTML;
                // var originalContents = document.body.innerHTML;
                // document.body.innerHTML = printContents;
                // window.print();
                // document.body.innerHTML = originalContents;

                var newWin = window.open('', 'win');
                newWin.document.write(div.innerHTML);
                newWin.location.reload();
                newWin.focus();
                newWin.print();
                newWin.close();
            }
        }
</script>

<script src="https://kendo.cdn.telerik.com/2019.1.220/js/kendo.all.min.js"></script>
<script>
    var data = JSON.parse($('#variableJSON').text());
    console.log(data);
    $('#variableJSON').remove();
    $(document).ready(function () {
        $("#grid").kendoGrid({
            dataSource: {
                data: data,
                schema: {
                    model: {
                        fields: {
                            name: {type: "string"},
                            organization: {type: "string"},
                            designation: {type: "string"},
                            contact_number: {type: "string"},
                            address: {type: "string"},
                        }
                    }
                },
                pageSize: 10
            },
            tooltip: true,
            scrollable: true,
            sortable: true,
            filterable: true,
            tooltip: true,
            reorderable: true,
            resizable: true,
            pageable: {
                input: true,
                numeric: false,
                refresh: true,
                pageSizes: true,
                buttonCount: 5
            },
            // editable: "incell",
            columns: [
                {field: "name", title: "Name"},
                {field: "organization", title: "Organization"},
                {field: "designation", title: "Designation"},
                {field: "contact_number", title: "Mobile"},
                {field: "address", title: "Address"},
            ]
        });
    });
</script>

</body>
</html>
